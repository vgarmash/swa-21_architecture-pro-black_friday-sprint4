# Задание 9. Настройка чтения с реплик и консистентность

## Описание

1. Для коллекций **products** и **orders** и **carts** определите:
    - Какие операции чтения **могут** использовать secondary реплику для чтения.
    - Какие операции чтения **должны** читать только с primary.
    - Укажите, какая **задержка репликации** допустима для операций на secondary.
2. Обоснуйте выбор, опираясь на:
    - Требования к консистентности данных.
    - Частоту обновлений.
    - Бизнес-логику (например, риск продажи недоступного товара или отображение устаревшего статуса заказа пользователю).

## Решение

| Коллекция | Операция чтения | Требуемая консистентность | Частота обновлений | Источник | Допустимая задержка репликации | Обоснование |
|---|---|---|---|---|---|---|
| products | Поиск по `_id` (для обновления остатков)| Strong | Часто | primary |  0s | Риск продать отсутствующий товар |
| products | Поиск по `_id` (для описания на странице продукта)| Eventual | Очень редко | secondary | ≤ 60s | Допустимо устаревание описания |
| products | Поиск по `_id` (для формирования заказа/отображения корзины)| Strong | Часто | primary |  0s | Риск продать по старой цене |
| products | Поиск/фильтрация по `category` | Eventual | Редко | secondary | ≤ 60s | Допустимо устаревание набора найденных предложений |
| products | Поиск/фильтрация по диапазону цен | Eventual | Редко | secondary | ≤ 60s | Допустимо устаревание набора найденных предложений |
| orders | Поиск по `user_id` | Eventual | Редко | secondary | ≤ 30s |  Просмотр истории заказов. нежелательна, но допустима небольшая задержка |
| orders | Поиск по `_id` | Eventual | Редко | secondary | ≤ 30s | Можно програмно подождать появления заказа в реплике, редко меняется после создания |
| orders | Поиск по категории, гео-зоне | Eventual | Редко | secondary | ≤ 60s | Обработка на складах. Допустимо устаревание |
| carts | Поиск по `session_id`/`user_id` | Strong | Часто | primary | 0s |  Пользователь ожидает сразу увидеть свои изменения в корзине |