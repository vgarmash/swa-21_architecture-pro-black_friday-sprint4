# –ó–∞–¥–∞–Ω–∏–µ 9: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á—Ç–µ–Ω–∏—è —Å —Ä–µ–ø–ª–∏–∫ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

> üìñ –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è –º–µ–∂–¥—É Primary –∏ Secondary —Ä–µ–ø–ª–∏–∫–∞–º–∏  
> üè† [‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ README](../README.md) | üî• [–ó–∞–¥–∞–Ω–∏–µ 8: "–ì–æ—Ä—è—á–∏–µ" —à–∞—Ä–¥—ã](TASK8_SUMMARY.md)

---

## üìö –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [Read Preference –≤ MongoDB](#read-preference-–≤-mongodb)
3. [–ê–Ω–∞–ª–∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–π](#–∞–Ω–∞–ª–∏–∑-–∫–æ–ª–ª–µ–∫—Ü–∏–π)
4. [–¢–∞–±–ª–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è](#—Ç–∞–±–ª–∏—Ü–∞-–æ–ø–µ—Ä–∞—Ü–∏–π-—á—Ç–µ–Ω–∏—è)
5. [–î–æ–ø—É—Å—Ç–∏–º–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏](#–¥–æ–ø—É—Å—Ç–∏–º–∞—è-–∑–∞–¥–µ—Ä–∂–∫–∞-—Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏)
6. [–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞](#–æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ-–≤—ã–±–æ—Ä–∞)
7. [–ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏](#–ø—Ä–∏–º–µ—Ä—ã-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
8. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ replication lag](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-replication-lag)
9. [Best Practices](#best-practices)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å replica sets –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤—ã–±–æ—Ä: –æ—Ç–∫—É–¥–∞ —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ?
- **Primary** - –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –≤—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
- **Secondary** - —Ä–∞–∑–≥—Ä—É–∑–∫–∞ Primary, –Ω–æ –≤–æ–∑–º–æ–∂–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ (replication lag)

### –¶–µ–ª—å

–û–ø—Ç–∏–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –º–µ–∂–¥—É —Ä–µ–ø–ª–∏–∫–∞–º–∏ —Å —É—á–µ—Ç–æ–º:
- ‚úÖ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö** - –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - —Ä–∞–∑–≥—Ä—É–∑–∫–∞ Primary
- ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏** - —Ä–∏—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–Ω—Ç–µ–∫—Å—Ç: –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω "–ú–æ–±–∏–ª—å–Ω—ã–π –º–∏—Ä"

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
- 2 —à–∞—Ä–¥–∞, –∫–∞–∂–¥—ã–π - replica set –∏–∑ 3 –Ω–æ–¥ (1 Primary + 2 Secondary)
- Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –≤–æ –≤—Ä–µ–º—è –∞–∫—Ü–∏–π ("—á–µ—Ä–Ω–∞—è –ø—è—Ç–Ω–∏—Ü–∞")

**–ö–æ–ª–ª–µ–∫—Ü–∏–∏**:
1. **products** - –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ (~50M –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
2. **orders** - –∏—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ (~100M –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
3. **carts** - –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–æ—Ä–∑–∏–Ω—ã (~5M –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)

---

## Read Preference –≤ MongoDB

### –†–µ–∂–∏–º—ã —á—Ç–µ–Ω–∏—è

| –†–µ–∂–∏–º | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-------|----------|-------------------|
| **primary** | –¢–æ–ª—å–∫–æ —Å Primary | –ö—Ä–∏—Ç–∏—á–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å |
| **primaryPreferred** | Primary, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω; –∏–Ω–∞—á–µ Secondary | –í–∞–∂–Ω–∞—è, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å |
| **secondary** | –¢–æ–ª—å–∫–æ —Å Secondary | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞, –æ—Ç—á–µ—Ç—ã |
| **secondaryPreferred** | Secondary, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω; –∏–Ω–∞—á–µ Primary | –†–∞–∑–≥—Ä—É–∑–∫–∞ Primary |
| **nearest** | –ù–∞–∏–º–µ–Ω—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–µ—Ç–∏ | –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã |

### Read Concern

| –£—Ä–æ–≤–µ–Ω—å | –û–ø–∏—Å–∞–Ω–∏–µ | –ì–∞—Ä–∞–Ω—Ç–∏–∏ |
|---------|----------|----------|
| **local** | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ (–º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã) | –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π |
| **available** | –ö–∞–∫ local, –Ω–æ –¥–ª—è sharded clusters | –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π |
| **majority** | –î–∞–Ω–Ω—ã–µ, —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –Ω–æ–¥ | –ù–µ –±—É–¥—É—Ç –æ—Ç–∫–∞—á–µ–Ω—ã (rollback) |
| **linearizable** | –°—Ç—Ä–æ–≥–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å | –°–∞–º–∞—è —Å—Ç—Ä–æ–≥–∞—è, –º–µ–¥–ª–µ–Ω–Ω–æ |

### Replication Lag (–∑–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏)

**–ß—Ç–æ —ç—Ç–æ**: –í—Ä–µ–º—è –º–µ–∂–¥—É –∑–∞–ø–∏—Å—å—é –Ω–∞ Primary –∏ –ø–æ—è–≤–ª–µ–Ω–∏–µ–º –Ω–∞ Secondary

**–¢–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
- ‚úÖ –ù–æ—Ä–º–∞: < 100ms
- ‚ö†Ô∏è –ü—Ä–∏–µ–º–ª–µ–º–æ: 100ms - 1s
- üî• –ü—Ä–æ–±–ª–µ–º–∞: > 1s

**–§–∞–∫—Ç–æ—Ä—ã**:
- –°–µ—Ç–µ–≤–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏
- –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Secondary (—á—Ç–µ–Ω–∏–µ + —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è)
- –†–∞–∑–º–µ—Ä oplog
- –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ –Ω–∞ Primary

---

## –ê–Ω–∞–ª–∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–π

### 1. –ö–æ–ª–ª–µ–∫—Ü–∏—è `products` (—Ç–æ–≤–∞—Ä—ã)

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- –†–∞–∑–º–µ—Ä: ~50M –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, ~80GB
- –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: **–°—Ä–µ–¥–Ω—è—è** (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –ø—Ä–æ–¥–∞–∂–µ)
- –ß–∞—Å—Ç–æ—Ç–∞ —á—Ç–µ–Ω–∏—è: **–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è** (–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞, –ø–æ–∏—Å–∫)
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ read/write: **95% / 5%**

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**:
- ‚ùó –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
- ‚ùó –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

**–ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**:
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞
- ‚úÖ –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π —Ç–æ–≤–∞—Ä–∞ (–¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è)

**–ë–∏–∑–Ω–µ—Å-—Ä–∏—Å–∫–∏**:
- üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ**: –ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (overselling) ‚Üí –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤, –≤–æ–∑–≤—Ä–∞—Ç—ã
- üü° **–î–æ–ø—É—Å—Ç–∏–º–æ**: –ü–æ–∫–∞–∑ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ü–µ–Ω—É –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
- üü¢ **–ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ**: –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ

### 2. –ö–æ–ª–ª–µ–∫—Ü–∏—è `orders` (–∑–∞–∫–∞–∑—ã)

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- –†–∞–∑–º–µ—Ä: ~100M –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, ~150GB
- –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: **–°—Ä–µ–¥–Ω—è—è** (–Ω–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã + –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤)
- –ß–∞—Å—Ç–æ—Ç–∞ —á—Ç–µ–Ω–∏—è: **–í—ã—Å–æ–∫–∞—è** (–∏—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ read/write: **80% / 20%**

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**:
- ‚ùó –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚ùó –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞

**–ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**:
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (–æ—Ç—á–µ—Ç—ã –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤

**–ë–∏–∑–Ω–µ—Å-—Ä–∏—Å–∫–∏**:
- üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ**: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∫–ª–∏–∫–µ ‚Üí –¥–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ –¥–µ–Ω–µ–≥
- üü° **–î–æ–ø—É—Å—Ç–∏–º–æ**: –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (1-2 —Å–µ–∫)
- üü¢ **–ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ**: –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–∞—Ö

### 3. –ö–æ–ª–ª–µ–∫—Ü–∏—è `carts` (–∫–æ—Ä–∑–∏–Ω—ã)

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**:
- –†–∞–∑–º–µ—Ä: ~5M –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, ~10GB
- –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: **–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è** (–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω)
- –ß–∞—Å—Ç–æ—Ç–∞ —á—Ç–µ–Ω–∏—è: **–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è** (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏)
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ read/write: **60% / 40%**
- TTL: 30 –¥–Ω–µ–π (–∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –∫–æ—Ä–∑–∏–Ω)

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**:
- ‚ùó –°–ª–∏—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ (–≥–æ—Å—Ç–µ–≤–∞—è + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è)
- ‚ùó –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–∏–∑–±–µ–∂–∞—Ç—å race condition)

**–ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**:
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π)
- ‚úÖ –ü–æ–¥—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ

**–ë–∏–∑–Ω–µ—Å-—Ä–∏—Å–∫–∏**:
- üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ**: –ü–æ—Ç–µ—Ä—è —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ ‚Üí –ø–ª–æ—Ö–æ–π UX, –ø–æ—Ç–µ—Ä—è –ø—Ä–æ–¥–∞–∂
- üü° **–î–æ–ø—É—Å—Ç–∏–º–æ**: –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ (500ms - 1s)
- üü¢ **–ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ**: –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å—á–µ—Ç—á–∏–∫–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ

---

## –¢–∞–±–ª–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `products`

| ‚Ññ | –û–ø–µ—Ä–∞—Ü–∏—è | Read Preference | Read Concern | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---|----------|-----------------|--------------|-------------|
| 1 | **–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤**<br/>`db.products.find({ category: "electronics" }).limit(20)` | `secondaryPreferred` | `local` | ‚úÖ –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å<br/>‚úÖ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤<br/>‚úÖ –ö–µ—à–∏—Ä—É–µ—Ç—Å—è –≤ Redis<br/>‚ö†Ô∏è –ó–∞–¥–µ—Ä–∂–∫–∞ 1-2 —Å–µ–∫ –¥–æ–ø—É—Å—Ç–∏–º–∞ |
| 2 | **–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤**<br/>`db.products.find({ $text: { $search: "iPhone" } })` | `secondaryPreferred` | `local` | ‚úÖ –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∫–∞—Ç–∞–ª–æ–≥—É<br/>‚úÖ –†–∞–∑–≥—Ä—É–∑–∫–∞ Primary<br/>‚úÖ –ú–æ–∂–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å |
| 3 | **–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π —Ç–æ–≤–∞—Ä–∞**<br/>`db.products.findOne({ product_id: "PROD-123" })` | `secondaryPreferred` | `local` | ‚úÖ –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å<br/>‚úÖ –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞<br/>‚úÖ –ö–µ—à–∏—Ä—É–µ—Ç—Å—è –≤ Redis |
| 4 | **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É**<br/>`db.products.findOne({ product_id: "PROD-123" }, { stock: 1 })` | `primaryPreferred` | `local` | ‚ö†Ô∏è –£–º–µ—Ä–µ–Ω–Ω–æ –≤–∞–∂–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å<br/>‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ –ø–æ–∫—É–ø–∞–µ—Ç<br/>‚úÖ Primary preferred –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ |
| 5 | **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞**<br/>`db.products.findOne({ product_id: "PROD-123", stock: { $gte: quantity } })` | `primary` | `majority` | üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ!** –†–∏—Å–∫ overselling<br/>üî¥ –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ<br/>üî¥ Majority - –∑–∞—â–∏—Ç–∞ –æ—Ç rollback |
| 6 | **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º/—Ü–µ–Ω–µ**<br/>`db.products.find({ category: "phones", price: { $lt: 500 } })` | `secondaryPreferred` | `local` | ‚úÖ –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∫–∞—Ç–∞–ª–æ–≥—É<br/>‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º–∞ |
| 7 | **–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**<br/>`db.products.aggregate([{ $group: { _id: "$category", count: { $sum: 1 } } }])` | `secondary` | `local` | ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞<br/>‚úÖ –¢—è–∂–µ–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚Üí –Ω–∞ Secondary<br/>‚úÖ –†–∞–∑–≥—Ä—É–∑–∫–∞ Primary |

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `orders`

| ‚Ññ | –û–ø–µ—Ä–∞—Ü–∏—è | Read Preference | Read Concern | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---|----------|-----------------|--------------|-------------|
| 1 | **–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**<br/>`db.orders.find({ user_id: "USER-123" }).sort({ created_at: -1 })` | `secondaryPreferred` | `local` | ‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ 1-2 —Å–µ–∫ –¥–æ–ø—É—Å—Ç–∏–º–∞<br/>‚úÖ –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è UX<br/>‚úÖ –†–∞–∑–≥—Ä—É–∑–∫–∞ Primary |
| 2 | **–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞**<br/>`db.orders.findOne({ order_id: "ORDER-456" })` | `secondaryPreferred` | `local` | ‚úÖ –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏<br/>‚ö†Ô∏è –ï—Å–ª–∏ –Ω—É–∂–µ–Ω –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å ‚Üí primary |
| 3 | **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ (–¥—É–±–ª–∏–∫–∞—Ç)**<br/>`db.orders.findOne({ user_id: "USER-123", created_at: { $gt: Date.now() - 60000 } })` | `primary` | `majority` | üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ!** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–µ–π<br/>üî¥ –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã<br/>üî¥ Majority - –∑–∞—â–∏—Ç–∞ –æ—Ç rollback |
| 4 | **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π/webhook**<br/>`db.orders.findOne({ order_id: "ORDER-456" }, { status: 1 })` | `primary` | `majority` | üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ!** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã<br/>üî¥ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å ‚Üí –æ—à–∏–±–∫–∞ –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ |
| 5 | **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (–æ—Ç—á–µ—Ç—ã)**<br/>`db.orders.aggregate([...])` | `secondary` | `local` | ‚úÖ –û—Ç—á–µ—Ç—ã –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏<br/>‚úÖ –¢—è–∂–µ–ª—ã–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ ‚Üí –Ω–∞ Secondary<br/>‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ 5-10 —Å–µ–∫ –¥–æ–ø—É—Å—Ç–∏–º–∞ |
| 6 | **–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤ (CSV, Excel)**<br/>`db.orders.find({ created_at: { $gte: startDate } })` | `secondary` | `local` | ‚úÖ –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ<br/>‚úÖ Batch –æ–ø–µ—Ä–∞—Ü–∏—è ‚Üí –Ω–∞ Secondary |
| 7 | **–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞/email**<br/>`db.orders.find({ "customer.email": "user@example.com" })` | `primaryPreferred` | `local` | ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–ª—è support (–≤–∞–∂–Ω–æ)<br/>‚ö†Ô∏è Primary preferred –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ |

### –ö–æ–ª–ª–µ–∫—Ü–∏—è `carts`

| ‚Ññ | –û–ø–µ—Ä–∞—Ü–∏—è | Read Preference | Read Concern | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---|----------|-----------------|--------------|-------------|
| 1 | **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**<br/>`db.carts.findOne({ user_id: "USER-123", status: "active" })` | `primaryPreferred` | `local` | ‚ö†Ô∏è –í–∞–∂–Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å (–Ω–µ–¥–∞–≤–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è)<br/>‚ö†Ô∏è Primary preferred, –Ω–æ Secondary OK –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ<br/>‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ 500ms - 1s –¥–æ–ø—É—Å—Ç–∏–º–∞ |
| 2 | **–ü–æ–ª—É—á–µ–Ω–∏–µ –≥–æ—Å—Ç–µ–≤–æ–π –∫–æ—Ä–∑–∏–Ω—ã**<br/>`db.carts.findOne({ session_id: "SESSION-789", status: "active" })` | `primaryPreferred` | `local` | ‚ö†Ô∏è –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –∫–æ—Ä–∑–∏–Ω–µ |
| 3 | **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–æ—Ä–∑–∏–Ω—ã –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º**<br/>`db.carts.findOne({ user_id: "USER-123", status: "active" })` | `primary` | `majority` | üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ!** –ò–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–µ–π –∫–æ—Ä–∑–∏–Ω<br/>üî¥ Race condition –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö |
| 4 | **–°–ª–∏—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω (—á—Ç–µ–Ω–∏–µ –≥–æ—Å—Ç–µ–≤–æ–π + –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π)**<br/>`db.carts.find({ $or: [{ session_id: "..." }, { user_id: "..." }] })` | `primary` | `majority` | üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ!** –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ —Ç–æ–≤–∞—Ä–æ–≤<br/>üî¥ –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –æ–±–µ –∫–æ—Ä–∑–∏–Ω—ã –∞–∫—Ç—É–∞–ª—å–Ω–æ |
| 5 | **–ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ (badge)**<br/>`db.carts.aggregate([{ $match: { user_id: "..." } }, { $unwind: "$items" }, { $count: "total" }])` | `secondaryPreferred` | `local` | ‚úÖ –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ (–∫–æ—Å–º–µ—Ç–∏–∫–∞ UI)<br/>‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ 1-2 —Å–µ–∫ –¥–æ–ø—É—Å—Ç–∏–º–∞<br/>‚úÖ –ú–æ–∂–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å |
| 6 | **–ü–æ–ª—É—á–µ–Ω–∏–µ abandoned carts –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞**<br/>`db.carts.find({ status: "abandoned", updated_at: { $lt: Date.now() - 3600000 } })` | `secondary` | `local` | ‚úÖ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∞—è –∑–∞–¥–∞—á–∞<br/>‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏<br/>‚úÖ –ó–∞–¥–µ—Ä–∂–∫–∞ 5-10 –º–∏–Ω –¥–æ–ø—É—Å—Ç–∏–º–∞ |

---

## –î–æ–ø—É—Å—Ç–∏–º–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

### –£—Ä–æ–≤–Ω–∏ –∑–∞–¥–µ—Ä–∂–∫–∏

| –£—Ä–æ–≤–µ–Ω—å | –ó–∞–¥–µ—Ä–∂–∫–∞ | –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å | –ü—Ä–∏–º–µ—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–π |
|---------|----------|--------------|------------------|
| **–ö—Ä–∏—Ç–∏—á–Ω–æ (0ms)** | 0ms | Primary only | ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ<br/>‚Ä¢ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–µ–π –∑–∞–∫–∞–∑–æ–≤<br/>‚Ä¢ –°–ª–∏—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω |
| **–í–∞–∂–Ω–æ (‚â§100ms)** | ‚â§ 100ms | Primary Preferred | ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É<br/>‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br/>‚Ä¢ –ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤ support |
| **–î–æ–ø—É—Å—Ç–∏–º–æ (‚â§1s)** | ‚â§ 1 —Å–µ–∫—É–Ω–¥–∞ | Secondary Preferred | ‚Ä¢ –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤<br/>‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è<br/>‚Ä¢ –î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞ |
| **–ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ (‚â§5s)** | ‚â§ 5 —Å–µ–∫—É–Ω–¥ | Secondary | ‚Ä¢ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã<br/>‚Ä¢ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö<br/>‚Ä¢ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ |

### –¢–∞–±–ª–∏—Ü–∞ –ø–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º

| –ö–æ–ª–ª–µ–∫—Ü–∏—è | –û–ø–µ—Ä–∞—Ü–∏—è | Max Lag | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|-----------|----------|---------|-------------|
| **products** | –ö–∞—Ç–∞–ª–æ–≥, –ø–æ–∏—Å–∫ | **1-2 —Å–µ–∫—É–Ω–¥—ã** | ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–º–µ—Ç–∏—Ç –∑–∞–¥–µ—Ä–∂–∫—É<br/>‚úÖ –ö–µ—à –≤ Redis –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç<br/>‚úÖ –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–∫—É–ø–∫—É |
| **products** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ (–∫–æ—Ä–∑–∏–Ω–∞) | **100ms** | ‚ö†Ô∏è –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ<br/>‚ö†Ô∏è –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—É–¥–µ—Ç –Ω–∞ Primary |
| **products** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ (–∑–∞–∫–∞–∑) | **0ms (Primary)** | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è overselling |
| **orders** | –ò—Å—Ç–æ—Ä–∏—è, –¥–µ—Ç–∞–ª–∏ | **1-2 —Å–µ–∫—É–Ω–¥—ã** | ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–æ—à–ª—ã–µ –∑–∞–∫–∞–∑—ã<br/>‚úÖ –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º–∞ |
| **orders** | –î—É–±–ª–∏–∫–∞—Ç—ã, —Å—Ç–∞—Ç—É—Å | **0ms (Primary)** | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ |
| **orders** | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ | **5-10 —Å–µ–∫—É–Ω–¥** | ‚úÖ –û—Ç—á–µ—Ç—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ |
| **carts** | –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã | **500ms - 1 —Å–µ–∫—É–Ω–¥–∞** | ‚ö†Ô∏è –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ<br/>‚ö†Ô∏è UX —Å—Ç—Ä–∞–¥–∞–µ—Ç –ø—Ä–∏ –±–æ–ª—å—à–µ–π –∑–∞–¥–µ—Ä–∂–∫–µ |
| **carts** | –°–ª–∏—è–Ω–∏–µ, —Å–æ–∑–¥–∞–Ω–∏–µ | **0ms (Primary)** | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö |
| **carts** | –°—á–µ—Ç—á–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤ | **1-2 —Å–µ–∫—É–Ω–¥—ã** | ‚úÖ –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–∞—è UI –¥–µ—Ç–∞–ª—å |

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤**:
```javascript
// Alert –µ—Å–ª–∏ replication lag > 1 —Å–µ–∫—É–Ω–¥–∞
if (replicationLag > 1000ms) {
  sendAlert("CRITICAL: Replication lag is " + replicationLag + "ms")
}

// Warning –µ—Å–ª–∏ > 500ms
if (replicationLag > 500ms) {
  sendAlert("WARNING: Replication lag is " + replicationLag + "ms")
}
```

---

## –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞

### 1. –ö–æ–ª–ª–µ–∫—Ü–∏—è `products` - –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —Ä–∞–∑–≥—Ä—É–∑–∫—É Primary

**–†–µ—à–µ–Ω–∏–µ**: –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ **Secondary**

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- **95% –æ–ø–µ—Ä–∞—Ü–∏–π** (–∫–∞—Ç–∞–ª–æ–≥, –ø–æ–∏—Å–∫, –¥–µ—Ç–∞–ª–∏) **–Ω–µ —Ç—Ä–µ–±—É—é—Ç —Å—Ç—Ä–æ–≥–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã ‚Üí –∑–∞–¥–µ—Ä–∂–∫–∞ 1-2 —Å–µ–∫ –Ω–µ–∑–∞–º–µ—Ç–Ω–∞
- –ü—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ –±—É–¥–µ—Ç **—Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Primary** ‚Üí overselling –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω

#### –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–°—Ä–µ–¥–Ω—è—è**: –æ—Å—Ç–∞—Ç–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø—Ä–æ–¥–∞–∂–µ (~1000 –ø—Ä–æ–¥–∞–∂/–º–∏–Ω –≤ –æ–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è)
- **–í—ã—Å–æ–∫–∞—è –≤ –ø–∏–∫–∏**: –¥–æ 10,000 –ø—Ä–æ–¥–∞–∂/–º–∏–Ω –≤–æ –≤—Ä–µ–º—è "—á–µ—Ä–Ω–æ–π –ø—è—Ç–Ω–∏—Ü—ã"
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã–µ (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä) ‚Üí –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –≤–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥

#### –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- ‚úÖ **–ü–æ–∫–∞–∑ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ** ‚Üí –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
- ‚úÖ **–ü–æ–∫–∞–∑ —Ç–æ–≤–∞—Ä–∞ "–≤ –Ω–∞–ª–∏—á–∏–∏" –∫–æ–≥–¥–∞ –µ–≥–æ –Ω–µ—Ç** ‚Üí –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏
- üî¥ **–ü—Ä–æ–¥–∞–∂–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞** ‚Üí **–ö–†–ò–¢–ò–ß–ù–û**, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –∑–∞–∫–∞–∑–µ ‚Üí Primary + majority

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- üìâ –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Primary: **-70%** (—Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–∏ + –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —á—Ç–µ–Ω–∏—è)
- üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –∫–∞—Ç–∞–ª–æ–≥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è Secondary —Ä–µ–ø–ª–∏–∫–∞–º–∏
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: overselling –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ Primary

### 2. –ö–æ–ª–ª–µ–∫—Ü–∏—è `orders` - –∞–∫—Ü–µ–Ω—Ç –Ω–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ**: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ **Primary**, –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ **Secondary**

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- **–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤** ‚Üí eventual consistency OK
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã** (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, webhook, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏) ‚Üí **—Å—Ç—Ä–æ–≥–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**
- **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–µ–π** ‚Üí **—Å—Ç—Ä–æ–≥–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**

#### –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ**: –Ω–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤**: –∫–∞–∂–¥—ã–π –∑–∞–∫–∞–∑ –ø—Ä–æ—Ö–æ–¥–∏—Ç 5-7 —Å—Ç–∞—Ç—É—Å–æ–≤
- **–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –∑–∞–ø–∏—Å—å**: ~1000 –∑–∞–∫–∞–∑–æ–≤/–º–∏–Ω + ~5000 –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤/–º–∏–Ω

#### –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- ‚úÖ **–ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Üí –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –ø—Ä–æ—à–ª—ã–µ –∑–∞–∫–∞–∑—ã
- üî¥ **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞** ‚Üí **–ö–†–ò–¢–ò–ß–ù–û**, –ø–æ—Ç–µ—Ä—è –¥–µ–Ω–µ–≥, –≤–æ–∑–≤—Ä–∞—Ç—ã
- üî¥ **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤ webhook** ‚Üí **–ö–†–ò–¢–ò–ß–ù–û**, –æ—à–∏–±–∫–∏ –≤ ERP/CRM —Å–∏—Å—Ç–µ–º–∞—Ö
- üü° **–ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–µ** ‚Üí –¥–æ–ø—É—Å—Ç–∏–º–æ, –æ—Ç—á–µ—Ç—ã –Ω–µ real-time

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- üìâ –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Primary: **-40%** (—Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
- ‚úÖ UX: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∏—Å—Ç–æ—Ä–∏—é —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (Secondary)

### 3. –ö–æ–ª–ª–µ–∫—Ü–∏—è `carts` - –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É UX –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

**–†–µ—à–µ–Ω–∏–µ**: **Primary Preferred** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã, **Primary** –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ**:

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã** ‚Üí –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
- **–°–ª–∏—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω** ‚Üí **—Å—Ç—Ä–æ–≥–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** (—Ä–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ —Ç–æ–≤–∞—Ä–æ–≤)
- **–ò–∑–±–µ–∂–∞–Ω–∏–µ –¥—É–±–ª–µ–π –∫–æ—Ä–∑–∏–Ω** ‚Üí **—Å—Ç—Ä–æ–≥–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** (race condition)

#### –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è**: –∫–æ—Ä–∑–∏–Ω—ã –º–µ–Ω—è—é—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ read/write: **60% / 40%** (—Å–∞–º–æ–µ –≤—ã—Å–æ–∫–æ–µ —Å—Ä–µ–¥–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–π)
- –ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí —á—Ç–µ–Ω–∏–µ + –∑–∞–ø–∏—Å—å

#### –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- üü° **–ó–∞–¥–µ—Ä–∂–∫–∞ –≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã** ‚Üí –¥–æ–ø—É—Å—Ç–∏–º–∞ 500ms - 1s
- üî¥ **–ü–æ—Ç–µ—Ä—è —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ —Å–ª–∏—è–Ω–∏–∏ –∫–æ—Ä–∑–∏–Ω** ‚Üí **–ö–†–ò–¢–ò–ß–ù–û**, –ø–ª–æ—Ö–æ–π UX, –ø–æ—Ç–µ—Ä—è –ø—Ä–æ–¥–∞–∂
- üî¥ **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω** ‚Üí **–ö–†–ò–¢–ò–ß–ù–û**, –ø—É—Ç–∞–Ω–∏—Ü–∞ –≤ UI
- ‚úÖ **–ó–∞–¥–µ—Ä–∂–∫–∞ –≤ —Å—á–µ—Ç—á–∏–∫–µ –∫–æ—Ä–∑–∏–Ω—ã** ‚Üí –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω–æ, –∫–æ—Å–º–µ—Ç–∏–∫–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚öñÔ∏è –ë–∞–ª–∞–Ω—Å: UX (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–æ—Ä–∑–∏–Ω–∞) vs –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Ä–∞–∑–≥—Ä—É–∑–∫–∞ Primary)
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Å–ª–∏—è–Ω–∏–µ) –Ω–∞ Primary
- üìâ –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Primary: **-30%** (—á–∞—Å—Ç—å —á—Ç–µ–Ω–∏–π –Ω–∞ Secondary)

---

## –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### Python (Motor + AsyncIO)

```python
from motor.motor_asyncio import AsyncIOMotorClient
from pymongo import ReadPreference, WriteConcern
from pymongo.read_concern import ReadConcern

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
client = AsyncIOMotorClient('mongodb://mongos:27017/')
db = client.mobile_world

# 1. PRODUCTS: –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ - Secondary Preferred
async def get_product_catalog(category: str):
    collection = db.get_collection(
        'products',
        read_preference=ReadPreference.SECONDARY_PREFERRED,
        read_concern=ReadConcern('local')
    )
    
    return await collection.find(
        {"category": category, "is_active": True}
    ).limit(20).to_list(length=20)

# 2. PRODUCTS: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ - Primary + Majority
async def check_stock_for_order(product_id: str, quantity: int):
    collection = db.get_collection(
        'products',
        read_preference=ReadPreference.PRIMARY,
        read_concern=ReadConcern('majority')
    )
    
    product = await collection.find_one({
        "product_id": product_id,
        "stock.quantity": {"$gte": quantity}
    })
    
    return product is not None

# 3. ORDERS: –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ - Secondary Preferred
async def get_user_orders(user_id: str):
    collection = db.get_collection(
        'orders',
        read_preference=ReadPreference.SECONDARY_PREFERRED,
        read_concern=ReadConcern('local')
    )
    
    return await collection.find(
        {"user_id": user_id}
    ).sort("created_at", -1).limit(10).to_list(length=10)

# 4. ORDERS: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ - Primary + Majority
async def check_duplicate_order(user_id: str, cart_hash: str):
    collection = db.get_collection(
        'orders',
        read_preference=ReadPreference.PRIMARY,
        read_concern=ReadConcern('majority')
    )
    
    recent_order = await collection.find_one({
        "user_id": user_id,
        "cart_hash": cart_hash,
        "created_at": {"$gt": datetime.now() - timedelta(minutes=5)}
    })
    
    return recent_order is not None

# 5. CARTS: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã - Primary Preferred
async def get_user_cart(user_id: str):
    collection = db.get_collection(
        'carts',
        read_preference=ReadPreference.PRIMARY_PREFERRED,
        read_concern=ReadConcern('local')
    )
    
    return await collection.find_one({
        "user_id": user_id,
        "status": "active"
    })

# 6. CARTS: –°–ª–∏—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω - Primary + Majority
async def merge_carts(session_id: str, user_id: str):
    collection = db.get_collection(
        'carts',
        read_preference=ReadPreference.PRIMARY,
        read_concern=ReadConcern('majority'),
        write_concern=WriteConcern(w='majority')
    )
    
    # –ß–∏—Ç–∞–µ–º –æ–±–µ –∫–æ—Ä–∑–∏–Ω—ã
    guest_cart = await collection.find_one({
        "session_id": session_id,
        "status": "active"
    })
    
    user_cart = await collection.find_one({
        "user_id": user_id,
        "status": "active"
    })
    
    # –°–ª–∏—è–Ω–∏–µ –ª–æ–≥–∏–∫–∏...
    # ...

# 7. ORDERS: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - Secondary
async def get_orders_analytics(start_date, end_date):
    collection = db.get_collection(
        'orders',
        read_preference=ReadPreference.SECONDARY,
        read_concern=ReadConcern('local')
    )
    
    pipeline = [
        {"$match": {"created_at": {"$gte": start_date, "$lte": end_date}}},
        {"$group": {
            "_id": "$status",
            "count": {"$sum": 1},
            "total_amount": {"$sum": "$total_amount"}
        }}
    ]
    
    return await collection.aggregate(pipeline).to_list(length=None)
```

### MongoDB Shell (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫)

```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ read preference
db.getMongo().getReadPrefMode()

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ read preference –¥–ª—è —Å–µ—Å—Å–∏–∏
db.getMongo().setReadPref("secondaryPreferred")

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ read preference –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
db.products.find({ category: "electronics" }).readPref("secondary")

// –ü—Ä–æ–≤–µ—Ä–∫–∞ read concern
db.products.find().readConcern("majority")

// –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø—Ä–∏–º–µ—Ä
db.products.find(
  { category: "electronics" }
).readPref("secondaryPreferred").readConcern("local").limit(20)
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

```python
# config.py

from pymongo import ReadPreference
from pymongo.read_concern import ReadConcern

# Read preferences –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
READ_PREFERENCES = {
    # PRODUCTS
    "products.catalog": ReadPreference.SECONDARY_PREFERRED,
    "products.search": ReadPreference.SECONDARY_PREFERRED,
    "products.details": ReadPreference.SECONDARY_PREFERRED,
    "products.stock_check_cart": ReadPreference.PRIMARY_PREFERRED,
    "products.stock_check_order": ReadPreference.PRIMARY,
    "products.analytics": ReadPreference.SECONDARY,
    
    # ORDERS
    "orders.history": ReadPreference.SECONDARY_PREFERRED,
    "orders.details": ReadPreference.SECONDARY_PREFERRED,
    "orders.duplicate_check": ReadPreference.PRIMARY,
    "orders.status_webhook": ReadPreference.PRIMARY,
    "orders.analytics": ReadPreference.SECONDARY,
    "orders.export": ReadPreference.SECONDARY,
    
    # CARTS
    "carts.get": ReadPreference.PRIMARY_PREFERRED,
    "carts.merge": ReadPreference.PRIMARY,
    "carts.create_check": ReadPreference.PRIMARY,
    "carts.count": ReadPreference.SECONDARY_PREFERRED,
    "carts.abandoned": ReadPreference.SECONDARY,
}

# Read concerns –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
READ_CONCERNS = {
    # –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ - majority
    "products.stock_check_order": ReadConcern("majority"),
    "orders.duplicate_check": ReadConcern("majority"),
    "orders.status_webhook": ReadConcern("majority"),
    "carts.merge": ReadConcern("majority"),
    "carts.create_check": ReadConcern("majority"),
    
    # –û—Å—Ç–∞–ª—å–Ω—ã–µ - local
    "default": ReadConcern("local"),
}

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
def get_read_settings(operation: str):
    read_pref = READ_PREFERENCES.get(operation, ReadPreference.PRIMARY)
    read_concern = READ_CONCERNS.get(operation, READ_CONCERNS["default"])
    return read_pref, read_concern

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
async def get_product_catalog_safe(category: str):
    read_pref, read_concern = get_read_settings("products.catalog")
    
    collection = db.get_collection(
        'products',
        read_preference=read_pref,
        read_concern=read_concern
    )
    
    return await collection.find({"category": category}).to_list(length=20)
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ replication lag

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

#### MongoDB Shell

```javascript
// 1. –ù–∞ Primary —à–∞—Ä–¥–∞
use admin
db.printSlaveReplicationInfo()

// –í—ã–≤–æ–¥:
// source: shard1-2:27018
//   syncedTo: Thu Jan 01 2024 12:34:56 GMT+0000 (UTC)
//   0 secs (0 hrs) behind the primary

// 2. –ù–∞ Secondary —à–∞—Ä–¥–µ
rs.printSecondaryReplicationInfo()

// 3. –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
rs.status()

// –°–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–æ–ª–µ "optimeDate" –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–¥—ã
// –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Primary –∏ Secondary = replication lag

// 4. Replication lag –¥–ª—è –≤—Å–µ—Ö —á–ª–µ–Ω–æ–≤
rs.status().members.forEach(member => {
    print(member.name + ": " + member.optimeDate)
})
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (—Å–∫—Ä–∏–ø—Ç)

```javascript
// monitor_replication_lag.js

function monitorReplicationLag() {
    const status = rs.status()
    const primary = status.members.find(m => m.state === 1)  // PRIMARY
    const secondaries = status.members.filter(m => m.state === 2)  // SECONDARY
    
    if (!primary) {
        print("ERROR: No PRIMARY found!")
        return
    }
    
    const primaryTime = primary.optimeDate
    
    print("=".repeat(50))
    print(`Replication Lag Report - ${new Date()}`)
    print("=".repeat(50))
    print(`PRIMARY: ${primary.name}`)
    print(`Primary Time: ${primaryTime}`)
    print("")
    
    secondaries.forEach(secondary => {
        const lag = (primaryTime - secondary.optimeDate) / 1000  // —Å–µ–∫—É–Ω–¥—ã
        
        let status = "‚úÖ OK"
        if (lag > 5) {
            status = "üî• CRITICAL"
        } else if (lag > 1) {
            status = "‚ö†Ô∏è  WARNING"
        }
        
        print(`${status} ${secondary.name}:`)
        print(`  Lag: ${lag.toFixed(3)} seconds`)
        print(`  Secondary Time: ${secondary.optimeDate}`)
        print(`  Health: ${secondary.health}`)
        print("")
        
        // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–ª–µ—Ä—Ç –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ
        if (lag > 5) {
            sendAlert({
                level: "CRITICAL",
                message: `Replication lag on ${secondary.name}: ${lag.toFixed(2)}s`,
                timestamp: new Date()
            })
        }
    })
}

function sendAlert(alert) {
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é –∞–ª–µ—Ä—Ç–æ–≤
    db.getSiblingDB("monitoring").alerts.insertOne(alert)
    print(`üö® ALERT: ${alert.message}`)
}

// –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
while (true) {
    monitorReplicationLag()
    sleep(10 * 1000)
}
```

#### –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –î–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞—Ä–¥–∞
mongosh --host shard1-1:27018 --file monitor_replication_lag.js &
mongosh --host shard2-1:27018 --file monitor_replication_lag.js &
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Prometheus

```yaml
# mongodb-exporter config
scrape_configs:
  - job_name: 'mongodb_replication'
    static_configs:
      - targets:
          - 'shard1-1:9216'
          - 'shard1-2:9216'
          - 'shard1-3:9216'
          - 'shard2-1:9216'
          - 'shard2-2:9216'
          - 'shard2-3:9216'
    metrics_path: '/metrics'
```

### Grafana Dashboard (–∞–ª–µ—Ä—Ç—ã)

```yaml
# grafana_alerts.yml

alerts:
  - alert: HighReplicationLag
    expr: mongodb_replset_oplog_lag_seconds > 1
    for: 1m
    labels:
      severity: warning
    annotations:
      summary: "Replication lag on {{ $labels.instance }}"
      description: "Lag is {{ $value }} seconds"
      
  - alert: CriticalReplicationLag
    expr: mongodb_replset_oplog_lag_seconds > 5
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "CRITICAL replication lag on {{ $labels.instance }}"
      description: "Lag is {{ $value }} seconds - immediate action required"
      
  - alert: SecondaryDown
    expr: mongodb_replset_member_health == 0
    for: 30s
    labels:
      severity: critical
    annotations:
      summary: "Secondary replica is down: {{ $labels.instance }}"
```

---

## Best Practices

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `maxStalenessSeconds`

**–ü—Ä–æ–±–ª–µ–º–∞**: Secondary –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ –æ—Ç—Å—Ç–∞—Ç—å (> 5 —Å–µ–∫—É–Ω–¥)

**–†–µ—à–µ–Ω–∏–µ**: –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É

```python
from pymongo import MongoClient, ReadPreference

client = MongoClient(
    'mongodb://mongos:27017/',
    readPreference='secondaryPreferred',
    maxStalenessSeconds=2  # –ú–∞–∫—Å–∏–º—É–º 2 —Å–µ–∫—É–Ω–¥—ã –∑–∞–¥–µ—Ä–∂–∫–∏
)

# –ï—Å–ª–∏ –≤—Å–µ Secondary –æ—Ç—Å—Ç–∞—é—Ç –±–æ–ª—å—à–µ —á–µ–º –Ω–∞ 2 —Å–µ–∫ ‚Üí —á–∏—Ç–∞–µ–º —Å Primary
```

### 2. Tagging Secondary –Ω–æ–¥

**–°—Ü–µ–Ω–∞—Ä–∏–π**: –†–∞–∑–Ω—ã–µ Secondary –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á

```javascript
// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è replica set
cfg = rs.conf()

// –ü–æ–º–µ—Ç–∏—Ç—å –Ω–æ–¥—ã —Ç–µ–≥–∞–º–∏
cfg.members[1].tags = { usage: "realtime" }   // shard1-2 –¥–ª—è real-time –∑–∞–ø—Ä–æ—Å–æ–≤
cfg.members[2].tags = { usage: "analytics" }  // shard1-3 –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

rs.reconfig(cfg)

// –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
db.products.find({ category: "electronics" }).readPref(
  "secondary",
  [{ usage: "realtime" }]  // –¢–æ–ª—å–∫–æ —Å –Ω–æ–¥ —Å —Ç–µ–≥–æ–º "realtime"
)

db.products.aggregate([...]).readPref(
  "secondary",
  [{ usage: "analytics" }]  // –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –Ω–æ–¥–∞—Ö
)
```

### 3. Hedged Reads (MongoDB 4.4+)

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–µ–¥–ª–µ–Ω–Ω—ã–π Secondary –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å –∑–∞–ø—Ä–æ—Å

**–†–µ—à–µ–Ω–∏–µ**: –î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–¥

```python
from pymongo import MongoClient

client = MongoClient(
    'mongodb://mongos:27017/',
    readPreference='secondaryPreferred',
    hedgedReads={'enabled': True}  # –í–∫–ª—é—á–∏—Ç—å hedged reads
)

# MongoDB –æ—Ç–ø—Ä–∞–≤–∏—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ Primary + Secondary –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
# –í–µ—Ä–Ω–µ—Ç –ø–µ—Ä–≤—ã–π –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
```

### 4. Read Preference –≤ –∞–≥—Ä–µ–≥–∞—Ü–∏—è—Ö

```javascript
// –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - –≤—Å–µ–≥–¥–∞ –Ω–∞ Secondary
db.orders.aggregate([
  { $match: { created_at: { $gte: startDate } } },
  { $group: { _id: "$status", count: { $sum: 1 } } }
], {
  readPreference: "secondary",
  readConcern: { level: "local" }
})

// –ö—Ä–∏—Ç–∏—á–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è - –Ω–∞ Primary
db.products.aggregate([
  { $match: { product_id: "PROD-123" } },
  { $lookup: { from: "inventory", localField: "product_id", foreignField: "product_id" } }
], {
  readPreference: "primary",
  readConcern: { level: "majority" }
})
```

### 5. Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

```python
async def get_product_with_fallback(product_id: str):
    try:
        # –ü–æ–ø—ã—Ç–∫–∞ 1: Secondary (–±—ã—Å—Ç—Ä–æ)
        collection = db.get_collection(
            'products',
            read_preference=ReadPreference.SECONDARY_PREFERRED,
            read_concern=ReadConcern('local')
        )
        
        product = await collection.find_one(
            {"product_id": product_id},
            maxTimeMS=100  # Timeout 100ms
        )
        
        return product
        
    except ExecutionTimeout:
        # –ü–æ–ø—ã—Ç–∫–∞ 2: Primary (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –Ω–∞–¥–µ–∂–Ω–æ)
        collection = db.get_collection(
            'products',
            read_preference=ReadPreference.PRIMARY
        )
        
        product = await collection.find_one({"product_id": product_id})
        return product
```

### 6. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å**: Redis –¥–ª—è —Å–∞–º—ã—Ö —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

```python
async def get_product_catalog_cached(category: str):
    cache_key = f"catalog:{category}"
    
    # 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis
    cached = await redis_client.get(cache_key)
    if cached:
        return json.loads(cached)
    
    # 2. –ß–∏—Ç–∞—Ç—å —Å Secondary MongoDB
    collection = db.get_collection(
        'products',
        read_preference=ReadPreference.SECONDARY_PREFERRED
    )
    
    products = await collection.find({"category": category}).limit(20).to_list(20)
    
    # 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Redis (TTL 60 —Å–µ–∫—É–Ω–¥)
    await redis_client.setex(cache_key, 60, json.dumps(products))
    
    return products
```

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ Read Preference

| Read Preference | –ö–æ–ª–ª–µ–∫—Ü–∏–∏ | –û–ø–µ—Ä–∞—Ü–∏–∏ | % –Ω–∞–≥—Ä—É–∑–∫–∏ |
|----------------|-----------|----------|-----------|
| **primary** | products, orders, carts | ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ (–∑–∞–∫–∞–∑)<br/>‚Ä¢ –î—É–±–ª–∏–∫–∞—Ç—ã –∑–∞–∫–∞–∑–æ–≤<br/>‚Ä¢ –°–ª–∏—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω<br/>‚Ä¢ Webhook/–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è | **~15%** |
| **primaryPreferred** | products, orders, carts | ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ (–∫–æ—Ä–∑–∏–Ω–∞)<br/>‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã<br/>‚Ä¢ –ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–æ–≤ (support) | **~25%** |
| **secondaryPreferred** | products, orders, carts | ‚Ä¢ –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤<br/>‚Ä¢ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤<br/>‚Ä¢ –î–µ—Ç–∞–ª–∏ —Ç–æ–≤–∞—Ä–∞<br/>‚Ä¢ –°—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã | **~50%** |
| **secondary** | products, orders, carts | ‚Ä¢ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞<br/>‚Ä¢ –û—Ç—á–µ—Ç—ã<br/>‚Ä¢ –≠–∫—Å–ø–æ—Ä—Ç<br/>‚Ä¢ –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ | **~10%** |

### –≠—Ñ—Ñ–µ–∫—Ç –æ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|---------------|-------------------|-----------|
| **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Primary** | 100% | **~35%** | üìâ -65% |
| **Throughput (ops/sec)** | 5,000 | **~13,000** | üìà +160% |
| **Latency (p95)** | 200ms | **~80ms** | üìâ -60% |
| **CPU Primary** | 85% | **~40%** | üìâ -53% |

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. ‚úÖ **–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Üí Primary + Majority**
   - Overselling prevention
   - –î—É–±–ª–∏–∫–∞—Ç—ã –∑–∞–∫–∞–∑–æ–≤
   - –°–ª–∏—è–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω

2. ‚úÖ **–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö ‚Üí Secondary Preferred**
   - –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
   - –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤
   - –î–µ—Ç–∞–ª–∏

3. ‚úÖ **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚Üí Secondary**
   - –û—Ç—á–µ—Ç—ã
   - –≠–∫—Å–ø–æ—Ä—Ç
   - –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥

4. ‚úÖ **–ó–∞–¥–µ—Ä–∂–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏**
   - –ö—Ä–∏—Ç–∏—á–Ω–æ: 0ms (Primary only)
   - –í–∞–∂–Ω–æ: ‚â§100ms
   - –î–æ–ø—É—Å—Ç–∏–º–æ: ‚â§1s
   - –ù–µ–∫—Ä–∏—Ç–∏—á–Ω–æ: ‚â§5s

5. ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - Replication lag < 1s
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ > 5s
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ Primary

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- üî• [TASK8_SUMMARY.md](TASK8_SUMMARY.md) - –≤—ã—è–≤–ª–µ–Ω–∏–µ "–≥–æ—Ä—è—á–∏—Ö" —à–∞—Ä–¥–æ–≤
- üìê [TASK7_SUMMARY.md](TASK7_SUMMARY.md) - –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–π
- üè† [README.md](../README.md) - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- üîÑ [TASK3_SUMMARY.md](TASK3_SUMMARY.md) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏
- üîß [TASK3_REPLICATION_SETUP.md](TASK3_REPLICATION_SETUP.md) - –¥–µ—Ç–∞–ª–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

---

**‚úÖ –ó–∞–¥–∞–Ω–∏–µ 9 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!**

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è –º–µ–∂–¥—É Primary –∏ Secondary —Ä–µ–ø–ª–∏–∫–∞–º–∏ —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.**

**üéâ –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ Primary —Å–Ω–∏–∂–µ–Ω–∞ –Ω–∞ 65%! Throughput —É–≤–µ–ª–∏—á–µ–Ω –Ω–∞ 160%!**

