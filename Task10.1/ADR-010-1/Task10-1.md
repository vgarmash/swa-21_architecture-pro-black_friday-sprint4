### <a name="_b7urdng99y53"></a>**Название задачи:**
ADR-010-1: Миграция на Cassandra для критически важных данных интернет-магазина "Мобильный мир"
### <a name="_hjk0fkfyohdk"></a>**Автор:**
Архитектурная команда "Мобильный мир"
### <a name="_uanumrh8zrui"></a>**Дата:**
28.09.2025
### **Контекст и описание проблемы**
Во время «чёрной пятницы» система MongoDB с шардированием на основе диапазонов (Range-Based Sharding) показала критические недостатки при масштабировании под нагрузкой 50,000 запросов/сек:

* Полное перераспределение данных при добавлении новых шардов вызывало деградацию производительности в самый критический момент
* Высокая задержка (latency) из-за затрат ресурсов на миграцию чанков между узлами 
* Невозможность быстрого масштабирования в реальном времени под растущей нагрузкой

### <a name="_qmphm5d6rvi3"></a>**Решение**

#### [Диаграмма компонентов C4](https://github.com/kotenev/architecture-pro-black_friday/blob/mobileworld/Task10.1/ADR-010-1/black_friday_C4_Component_Diagram_Cassandra.puml)

#### Классификация данных по критичности

| Тип данных           | Критичность | Требования                                                                                                        | Рекомендация по БД |
|----------------------|-------------|-------------------------------------------------------------------------------------------------------------------|--------------------|
| Корзины (carts)      | Высокая     | * Высокая скорость записи/чтения<br>* Временные данные (TTL)<br>* Допустима eventual consistency                  | Cassandra          |
| Сессии пользователей | Высокая     | * Очень высокая скорость записи<br>* TTL для автоочистки<br>* Геораспределённость                                 | Cassandra          |
| Товары (products)    | Средняя     | * Частое чтение, редкая запись<br>* Необходима strong consistency для остатков<br>* Сложные запросы по категориям | MongoDB            |
| Заказы (orders)      | Критическая | * ACID-транзакции<br>* Strong consistency<br>* Связи между сущностями                                             | MongoDB            |
| История заказов      | Низкая      | * Редкое чтение<br> Архивные данные<br>* Time-series характер                                                     | Cassandra          |
| Остатки товаров      | Критическая | * Атомарные операции<br>* Strong consistency<br>* Предотвращение overselling                                      | MongoDB            |


Также опишите, какой логикой вы руководствовались в ходе принятия решений и выбора технологий. Не забывайте, что необходимо учесть все функциональные и нефункциональные требования.
### <a name="_bjrr7veeh80c"></a>**Альтернативы**
Опишите здесь наиболее важные альтернативные решения.

**Недостатки, ограничения, риски**

Подробно опишите здесь недостатки, ограничения и риски выбранного решения.

